# рЃарЃЮрЃњрЃЮрЃа рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃЮрЃЌ Excel Import

## ­ЪЊЦ рЃАрЃгрЃарЃљрЃцрЃў рЃњрЃљрЃўрЃЊрЃў

### 1№ИЈРЃБ Template-рЃўрЃА рЃЕрЃљрЃЏрЃЮрЃбрЃЋрЃўрЃарЃЌрЃЋрЃљ

рЃњрЃљрЃ«рЃАрЃћрЃюрЃўрЃЌ рЃЉрЃарЃљрЃБрЃќрЃћрЃарЃерЃў:

**рЃърЃарЃЮрЃЊрЃБрЃЦрЃбрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА:**
```
http://localhost:5000/api/import/templates/products
```

**рЃЎрЃЮрЃЏрЃърЃљрЃюрЃўрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА:**
```
http://localhost:5000/api/import/templates/companies
```

рЃцрЃљрЃўрЃџрЃў рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃЕрЃљрЃЏрЃЮрЃўрЃбрЃЋрЃўрЃарЃЌрЃћрЃЉрЃљ рЃЌрЃЦрЃЋрЃћрЃюрЃА Downloads рЃцрЃЮрЃџрЃЊрЃћрЃарЃерЃў.

---

### 2№ИЈРЃБ Excel рЃцрЃљрЃўрЃџрЃўрЃА рЃерЃћрЃЋрЃАрЃћрЃЉрЃљ

#### рЃърЃарЃЮрЃЊрЃБрЃЦрЃбрЃћрЃЉрЃўрЃА рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў:

рЃњрЃљрЃ«рЃАрЃћрЃюрЃўрЃЌ `Products_Template.xlsx` рЃЊрЃљ рЃюрЃљрЃ«рЃљрЃЋрЃЌ:

| Name РГљ | Description | Barcode РГљ | Price | AlcoholPercentage | Volume (L) | Color | SugarContent | Manufacturer | Region | GrapeVariety | ServingTemperature | QualityClass |
|---------|-------------|-----------|-------|-------------------|------------|-------|--------------|--------------|--------|--------------|-------------------|--------------|
| Saperavi Reserve 2020 | Premium Georgian Red Wine | 1234567890123 | 45.50 | 13.5 | 0.75 | Red | 4.5 | Kakheti Winery | Kakheti | Saperavi | 16-18┬░C | Premium |

**рЃЊрЃљрЃљрЃЏрЃљрЃбрЃћрЃЌ рЃЌрЃЦрЃЋрЃћрЃюрЃў рЃърЃарЃЮрЃЊрЃБрЃЦрЃбрЃћрЃЉрЃў:**

| Name | Description | Barcode | Price | AlcoholPercentage | Volume (L) | Region | QualityClass |
|------|-------------|---------|-------|-------------------|------------|--------|--------------|
| Kindzmarauli 2021 | Semi-sweet Red Wine | 9876543210123 | 35.00 | 11.5 | 0.75 | Kakheti | Standard |
| Chacha Georgian | Traditional Brandy | 5555555555555 | 20.00 | 43 | 0.5 | Georgia | Premium |
| Borjomi | Mineral Water | 1111111111111 | 2.50 | | 0.5 | | |

РГљ = рЃљрЃБрЃфрЃўрЃџрЃћрЃЉрЃћрЃџрЃў рЃЋрЃћрЃџрЃћрЃЉрЃў

---

#### рЃЎрЃЮрЃЏрЃърЃљрЃюрЃўрЃћрЃЉрЃўрЃА рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў:

рЃњрЃљрЃ«рЃАрЃћрЃюрЃўрЃЌ `Companies_Template.xlsx` рЃЊрЃљ рЃюрЃљрЃ«рЃљрЃЋрЃЌ:

| Name РГљ | TaxId РГљ | Email | Phone | Address | CompanyType | IsPartner |
|---------|---------|-------|-------|---------|-------------|-----------|
| рЃарЃћрЃАрЃбрЃЮрЃарЃљрЃюрЃў ABC | 123456789 | info@restaurant.ge | +995 32 2 123456 | рЃЌрЃЉрЃўрЃџрЃўрЃАрЃў, рЃЋрЃљрЃЪрЃљ-рЃцрЃерЃљрЃЋрЃћрЃџрЃљрЃА 45 | Restaurant | Yes |

**рЃЊрЃљрЃљрЃЏрЃљрЃбрЃћрЃЌ рЃЌрЃЦрЃЋрЃћрЃюрЃў рЃЎрЃЮрЃЏрЃърЃљрЃюрЃўрЃћрЃЉрЃў:**

| Name | TaxId | Email | Phone | Address | CompanyType | IsPartner |
|------|-------|-------|-------|---------|-------------|-----------|
| рЃЉрЃљрЃарЃў рЃЏрЃљрЃарЃюрЃћрЃБрЃџрЃў | 234567890 | info@bar.ge | +995 599 123456 | рЃЏрЃљрЃарЃюрЃћрЃБрЃџрЃў, рЃарЃБрЃАрЃЌрЃљрЃЋрЃћрЃџрЃўрЃА 12 | Bar | No |
| рЃАрЃБрЃърЃћрЃарЃЏрЃљрЃарЃЎрЃћрЃбрЃў ABC | 345678901 | sales@market.ge | +995 32 2 999888 | рЃЌрЃЉрЃўрЃџрЃўрЃАрЃў, рЃљрЃдрЃЏрЃљрЃерЃћрЃюрЃћрЃЉрЃџрЃўрЃА 55 | Retail | Yes |
| рЃЦрЃАрЃћрЃџрЃў XYZ | 456789012 | contact@xyz.ge | +995 32 2 777666 | рЃЌрЃЉрЃўрЃџрЃўрЃАрЃў, рЃЊрЃљрЃЋрЃўрЃЌ рЃљрЃдрЃЏрЃљрЃерЃћрЃюрЃћрЃЉрЃџрЃўрЃА 100 | Chain | Yes |

РГљ = рЃљрЃБрЃфрЃўрЃџрЃћрЃЉрЃћрЃџрЃў рЃЋрЃћрЃџрЃћрЃЉрЃў

---

### 3№ИЈРЃБ рЃцрЃљрЃўрЃџрЃўрЃА рЃљрЃбрЃЋрЃўрЃарЃЌрЃЋрЃљ

#### рЃЋрЃљрЃарЃўрЃљрЃюрЃбрЃў A: Swagger UI (рЃЏрЃљрЃарЃбрЃўрЃЋрЃў)

1. рЃњрЃљрЃ«рЃАрЃћрЃюрЃўрЃЌ: http://localhost:5000/swagger
2. рЃўрЃърЃЮрЃЋрЃћрЃЌ **Import** рЃАрЃћрЃЦрЃфрЃўрЃљ
3. рЃљрЃўрЃарЃЕрЃўрЃћрЃЌ `/api/import/products` рЃљрЃю `/api/import/companies`
4. рЃЊрЃљрЃљрЃГрЃўрЃарЃћрЃЌ **"Try it out"**
5. **Choose File** - рЃљрЃўрЃарЃЕрЃўрЃћрЃЌ рЃЌрЃЦрЃЋрЃћрЃюрЃў `.xlsx` рЃцрЃљрЃўрЃџрЃў
6. рЃЊрЃљрЃљрЃГрЃўрЃарЃћрЃЌ **"Execute"**

#### рЃЋрЃљрЃарЃўрЃљрЃюрЃбрЃў B: PowerShell

```powershell
# рЃърЃарЃЮрЃЊрЃБрЃЦрЃбрЃћрЃЉрЃўрЃА рЃўрЃЏрЃърЃЮрЃарЃбрЃў
$file = Get-Item "C:\Users\YourName\Downloads\Products_Template.xlsx"
$form = @{ file = $file }
$result = Invoke-RestMethod -Uri "http://localhost:5000/api/import/products" -Method Post -Form $form
$result | ConvertTo-Json -Depth 10

# рЃЎрЃЮрЃЏрЃърЃљрЃюрЃўрЃћрЃЉрЃўрЃА рЃўрЃЏрЃърЃЮрЃарЃбрЃў
$file = Get-Item "C:\Users\YourName\Downloads\Companies_Template.xlsx"
$form = @{ file = $file }
$result = Invoke-RestMethod -Uri "http://localhost:5000/api/import/companies" -Method Post -Form $form
$result | ConvertTo-Json -Depth 10
```

---

### 4№ИЈРЃБ рЃерЃћрЃЊрЃћрЃњрЃўрЃА рЃерЃћрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃљ

рЃгрЃљрЃарЃЏрЃљрЃбрЃћрЃЉрЃўрЃА рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў рЃЊрЃљрЃўрЃюрЃљрЃ«рЃљрЃЋрЃЌ:

```json
{
  "isSuccess": true,
  "totalRows": 3,
  "added": 2,
  "updated": 1,
  "skipped": 0,
  "errors": [],
  "message": "рЃЊрЃљрЃАрЃарЃБрЃџрЃЊрЃљ: 2 рЃЊрЃљрЃћрЃЏрЃљрЃбрЃљ, 1 рЃњрЃљрЃюрЃљрЃ«рЃџрЃЊрЃљ, 0 рЃњрЃљрЃЏрЃЮрЃбрЃЮрЃЋрЃЊрЃљ"
}
```

**рЃарЃљ рЃЏрЃЮрЃ«рЃЊрЃљ:**
- РюЁ **2 рЃљрЃ«рЃљрЃџрЃў рЃЕрЃљрЃюрЃљрЃгрЃћрЃарЃў** рЃЊрЃљрЃћрЃЏрЃљрЃбрЃљ
- РюЁ **1 рЃљрЃарЃАрЃћрЃЉрЃБрЃџрЃў рЃЕрЃљрЃюрЃљрЃгрЃћрЃарЃў** рЃњрЃљрЃюрЃљрЃ«рЃџрЃЊрЃљ
- РюЁ **0 рЃЕрЃљрЃюрЃљрЃгрЃћрЃарЃў** рЃњрЃљрЃЏрЃЮрЃбрЃЮрЃЋрЃЊрЃљ

рЃерЃћрЃфрЃЊрЃЮрЃЏрЃћрЃЉрЃўрЃА рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў:

```json
{
  "isSuccess": false,
  "totalRows": 5,
  "added": 3,
  "updated": 1,
  "skipped": 1,
  "errors": [
    "рЃ«рЃљрЃќрЃў 4: Name рЃЋрЃћрЃџрЃў рЃАрЃљрЃЋрЃљрЃџрЃЊрЃћрЃЉрЃБрЃџрЃЮрЃљ",
    "рЃ«рЃљрЃќрЃў 6: Price рЃБрЃюрЃЊрЃљ рЃўрЃДрЃЮрЃА рЃЊрЃљрЃЊрЃћрЃЉрЃўрЃЌрЃў рЃарЃўрЃфрЃ«рЃЋрЃў"
  ],
  "message": "рЃЊрЃљрЃАрЃарЃБрЃџрЃЊрЃљ: 3 рЃЊрЃљрЃћрЃЏрЃљрЃбрЃљ, 1 рЃњрЃљрЃюрЃљрЃ«рЃџрЃЊрЃљ, 1 рЃњрЃљрЃЏрЃЮрЃбрЃЮрЃЋрЃЊрЃљ"
}
```

---

## ­ЪћЇ рЃерЃћрЃфрЃЊрЃЮрЃЏрЃћрЃЉрЃўрЃА рЃЏрЃЮрЃњрЃЋрЃљрЃарЃћрЃЉрЃљ

### рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ: "Excel рЃцрЃљрЃўрЃџрЃў рЃфрЃљрЃарЃўрЃћрЃџрЃўрЃљ"

**рЃЏрЃўрЃќрЃћрЃќрЃў:** рЃцрЃљрЃўрЃџрЃерЃў рЃљрЃа рЃљрЃарЃўрЃА рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў рЃљрЃю рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ header-рЃўрЃљ

**рЃњрЃљрЃЊрЃљрЃгрЃДрЃЋрЃћрЃбрЃљ:**
- рЃЊрЃљрЃљрЃЏрЃљрЃбрЃћрЃЌ рЃЏрЃўрЃюрЃўрЃЏрЃБрЃЏ рЃћрЃарЃЌрЃў рЃ«рЃљрЃќрЃў рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃЌ
- рЃЊрЃљрЃарЃгрЃЏрЃБрЃюрЃЊрЃўрЃЌ рЃарЃЮрЃЏ рЃърЃўрЃарЃЋрЃћрЃџ sheet-рЃќрЃћ рЃгрЃћрЃарЃЌ

---

### рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ: "UnitTypeRule (Liter) рЃЋрЃћрЃа рЃЏрЃЮрЃўрЃФрЃћрЃЉрЃюрЃљ"

**рЃЏрЃўрЃќрЃћрЃќрЃў:** рЃЉрЃљрЃќрЃљрЃерЃў рЃљрЃа рЃљрЃарЃўрЃА UnitTypeRules

**рЃњрЃљрЃЊрЃљрЃгрЃДрЃЋрЃћрЃбрЃљ:**
```powershell
cd C:\Users\Nmalidze\RiderProjects\WareHouseManagment
dotnet ef database update --project src/WareHouseManagement.Infrastructure --startup-project src/WareHouseManagement.API
```

---

### рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ: "рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ .xlsx рЃцрЃљрЃўрЃџрЃћрЃЉрЃў рЃЊрЃљрЃерЃЋрЃћрЃЉрЃБрЃџрЃўрЃљ"

**рЃЏрЃўрЃќрЃћрЃќрЃў:** рЃцрЃљрЃўрЃџрЃўрЃА рЃљ№┐й№┐й№┐йрЃљрЃАрЃгрЃЮрЃарЃў рЃцрЃЮрЃарЃЏрЃљрЃбрЃў

**рЃњрЃљрЃЊрЃљрЃгрЃДрЃЋрЃћрЃбрЃљ:**
- Excel-рЃерЃў: File Рєњ Save As Рєњ Excel Workbook (.xlsx)
- рЃљрЃарЃљ .xls, рЃљрЃарЃљ .csv, рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ .xlsx

---

### рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ: рЃЕрЃљрЃюрЃљрЃгрЃћрЃарЃў рЃљрЃа рЃњрЃљрЃюрЃљрЃ«рЃџрЃЊрЃљ

**рЃЏрЃўрЃќрЃћрЃќрЃў:** рЃБрЃюрЃўрЃЎрЃљрЃџрЃБрЃарЃў ID (Barcode/TaxId) рЃљрЃа рЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљ

**рЃарЃљрЃА рЃљрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃА рЃАрЃўрЃАрЃбрЃћрЃЏрЃљ:**
- **рЃърЃарЃЮрЃЊрЃБрЃЦрЃбрЃћрЃЉрЃў:** Barcode
- **рЃЎрЃЮрЃЏрЃърЃљрЃюрЃўрЃћрЃЉрЃў:** TaxId

рЃЌрЃБ рЃњрЃАрЃБрЃарЃЌ **рЃњрЃљрЃюрЃљрЃ«рЃџрЃћрЃЉрЃљ** - рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЌ рЃўрЃњрЃўрЃЋрЃћ Barcode/TaxId рЃарЃљрЃф рЃЉрЃљрЃќрЃљрЃерЃў рЃљрЃарЃўрЃА
рЃЌрЃБ рЃњрЃАрЃБрЃарЃЌ **рЃљрЃ«рЃљрЃџрЃў рЃЕрЃљрЃюрЃљрЃгрЃћрЃарЃў** - рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЌ рЃљрЃ«рЃљрЃџрЃў Barcode/TaxId

---

## ­ЪњА рЃарЃЕрЃћрЃЋрЃћрЃЉрЃў

### РюЁ рЃАрЃгрЃЮрЃарЃљрЃЊ:

```excel
Name              | Barcode        | Price
Saperavi 2020     | 1234567890123  | 45.50
Kindzmarauli      | 9876543210123  | 35.00
```

### РЮї рЃљрЃарЃљрЃАрЃгрЃЮрЃарЃљрЃЊ:

```excel
Name              | Barcode        | Price
                  | 1234567890123  | 45.50    РЮї Name рЃљрЃа рЃљрЃарЃўрЃА
Kindzmarauli      |                | 35.00    РЮї Barcode рЃљрЃа рЃљрЃарЃўрЃА
Chacha           | 1111           | -10      РЮї Price рЃБрЃљрЃарЃДрЃЮрЃцрЃўрЃЌрЃўрЃљ
```

---

## ­ЪЊі рЃарЃћрЃЎрЃЮрЃЏрЃћрЃюрЃЊрЃћрЃЉрЃБрЃџрЃў Workflow

### 1. рЃърЃўрЃарЃЋрЃћрЃџрЃў рЃўрЃЏрЃърЃЮрЃарЃбрЃў (рЃЏрЃфрЃўрЃарЃћ рЃбрЃћрЃАрЃбрЃў)

```powershell
# 1. рЃЕрЃљрЃЏрЃЮрЃбрЃЋрЃўрЃарЃЌрЃћ template
Invoke-WebRequest -Uri "http://localhost:5000/api/import/templates/products" -OutFile "Test_Products.xlsx"

# 2. рЃЊрЃљрЃљрЃЏрЃљрЃбрЃћ 2-3 рЃърЃарЃЮрЃЊрЃБрЃЦрЃбрЃў Excel-рЃерЃў

# 3. рЃљрЃбрЃЋрЃўрЃарЃЌрЃћ
$file = Get-Item "Test_Products.xlsx"
Invoke-RestMethod -Uri "http://localhost:5000/api/import/products" -Method Post -Form @{file=$file}
```

### 2. рЃЊрЃўрЃЊрЃў рЃўрЃЏрЃърЃЮрЃарЃбрЃў

1. **Backup рЃЉрЃљрЃќрЃўрЃАрЃљ** (рЃБрЃАрЃљрЃцрЃарЃЌрЃ«рЃЮрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА)
2. **10-20 рЃЕрЃљрЃюрЃљрЃгрЃћрЃарЃўрЃЌ** рЃбрЃћрЃАрЃбрЃў
3. **рЃерЃћрЃЊрЃћрЃњрЃўрЃА рЃерЃћрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃљ** Swagger-рЃўрЃЌ рЃљрЃю pgAdmin-рЃўрЃЌ
4. **рЃАрЃарЃБрЃџрЃў рЃўрЃЏрЃърЃЮрЃарЃбрЃў**

---

## ­Ъј» рЃърЃарЃљрЃЦрЃбрЃўрЃЎрЃБрЃџрЃў рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃћрЃЉрЃў

### рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў 1: 10 рЃдрЃЋрЃўрЃюрЃўрЃА рЃўрЃЏрЃърЃЮрЃарЃбрЃў

1. рЃњрЃљрЃЊрЃЏрЃЮрЃгрЃћрЃарЃћрЃЌ template
2. рЃерЃћрЃљрЃЋрЃАрЃћрЃЌ:

```
Name                    | Barcode        | Price | AlcoholPercentage | Region
Saperavi Reserve 2020   | 1000000000001  | 45    | 13.5             | Kakheti
Kindzmarauli 2021       | 1000000000002  | 35    | 11.5             | Kakheti
Mukuzani 2020           | 1000000000003  | 42    | 12.5             | Kakheti
Rkatsiteli Dry 2022     | 1000000000004  | 25    | 12.0             | Kakheti
Tsinandali 2021         | 1000000000005  | 30    | 12.0             | Kakheti
...
```

3. рЃљрЃбрЃЋрЃўрЃарЃЌрЃћрЃЌ Swagger-рЃўрЃЌ

### рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃў 2: 5 рЃЎрЃЮрЃЏрЃърЃљрЃюрЃўрЃўрЃА рЃўрЃЏрЃърЃЮрЃарЃбрЃў

```
Name              | TaxId      | CompanyType | IsPartner
рЃарЃћрЃАрЃбрЃЮрЃарЃљрЃюрЃў ABC    | 100000001  | Restaurant  | Yes
рЃЉрЃљрЃарЃў XYZ          | 100000002  | Bar         | No
рЃАрЃБрЃърЃћрЃарЃЏрЃљрЃарЃЎрЃћрЃбрЃў 123 | 100000003  | Retail      | Yes
рЃЦрЃАрЃћрЃџрЃў DEF         | 100000004  | Chain       | Yes
рЃарЃћрЃАрЃбрЃЮрЃарЃљрЃюрЃў GHI    | 100000005  | Restaurant  | No
```

---

рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌрЃў рЃЎрЃўрЃЌрЃ«рЃЋрЃћрЃЉрЃўрЃА рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў рЃўрЃ«рЃўрЃџрЃћрЃЌ: [EXCEL_IMPORT_GUIDE.md](./EXCEL_IMPORT_GUIDE.md)

